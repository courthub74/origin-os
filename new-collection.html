<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Dream OS — New Collection</title>
  <link rel="stylesheet" href="dreamos.css">

  <style>
    /* ===== Page layout ===== */
    .content{ margin-top: 14px; }

    .collections-grid{
      display:grid;
      grid-template-columns: 1.1fr 0.9fr;
      gap: 14px;
      align-items:start;
    }
    @media (max-width: 980px){
      .collections-grid{ grid-template-columns: 1fr; }
    }

    /* ===== Form fields (same feel as login) ===== */
    .field{
      border: 1px solid rgba(255,255,255,0.10);
      background: rgba(255,255,255,0.03);
      border-radius: 16px;
      padding: 12px;
      display:flex;
      flex-direction:column;
      gap: 8px;
    }
    .label{
      font-size: 11px;
      letter-spacing:.10em;
      text-transform: uppercase;
      color: var(--muted2);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
    }
    .hint{
      font-family: var(--mono);
      font-size: 11px;
      color: rgba(255,255,255,0.35);
      letter-spacing: .02em;
      text-transform:none;
    }

    input, textarea, select{
      width:100%;
      border: 1px solid rgba(255,255,255,0.10);
      background: rgba(255,255,255,0.02);
      border-radius: 14px;
      padding: 10px 12px;
      color: var(--text);
      outline:none;
      font-size: 14px;
      font-family: var(--sans);
    }
    textarea{ min-height: 110px; resize: vertical; }

    .two{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 520px){
      .two{ grid-template-columns: 1fr; }
    }

    /* ===== Upload row ===== */
    .uploadRow{
      display:flex;
      gap: 10px;
      align-items:center;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    .fileBtn{
      display:inline-flex;
      align-items:center;
      gap: 10px;
      border: 1px solid rgba(255,255,255,0.10);
      background: rgba(255,255,255,0.03);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 14px;
      cursor:pointer;
      box-shadow: 0 12px 30px rgba(0,0,0,0.25);
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
      user-select:none;
      font-size: 13px;
    }
    .fileBtn:hover{
      transform: translateY(-1px);
      border-color: var(--stroke-2);
      background: rgba(255,255,255,0.05);
    }
    .fileMeta{
      color: var(--muted);
      font-size: 12px;
      font-family: var(--mono);
      opacity: .85;
    }
    input[type="file"]{ display:none; }

    /* ===== Actions ===== */
    .formActions{
      margin-top: 10px;
      display:flex;
      gap: 10px;
    }
    .formActions .btn{ flex: 1; justify-content:center; }
    @media (max-width: 520px){
      .formActions{ flex-direction:column; }
      .formActions .btn{ width:100%; }
    }

    /* ===== Preview card ===== */
    .previewCard{
      border: 1px solid rgba(255,255,255,0.08);
      background: rgba(255,255,255,0.02);
      border-radius: 18px;
      overflow:hidden;
    }
    .previewTop{
      padding: 14px;
      border-bottom: 1px solid rgba(255,255,255,0.07);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
    }
    .previewTop .title{
      font-weight: 950;
      color: var(--text-2);
      letter-spacing:.02em;
      font-size: 14px;
    }
    .badge{
      font-family: var(--mono);
      font-size: 11px;
      color: rgba(255,255,255,0.65);
      border: 1px solid rgba(255,255,255,0.10);
      background: rgba(255,255,255,0.02);
      padding: 6px 10px;
      border-radius: 999px;
    }
    .previewBody{ padding: 14px; display:flex; flex-direction:column; gap: 12px; }
    .coverMock{
      height: 160px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,0.10);
      background:
        radial-gradient(650px 220px at 30% 20%, rgba(180,207,106,0.10), transparent 60%),
        radial-gradient(520px 240px at 85% 30%, rgba(120,90,255,0.14), transparent 60%),
        rgba(255,255,255,0.02);
      box-shadow: 0 18px 60px rgba(0,0,0,0.30);
      position:relative;
      overflow:hidden;
    }
    .coverMock .ghost{
      position:absolute;
      inset:auto 14px 14px 14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      color: rgba(255,255,255,0.55);
      font-family: var(--mono);
      font-size: 11px;
    }
    .previewMeta{
      display:flex;
      flex-direction:column;
      gap: 6px;
    }
    .previewMeta .name{
      font-size: 16px;
      font-weight: 950;
      color: var(--text-2);
      line-height: 1.2;
    }
    .previewMeta .desc{
      color: var(--muted);
      font-size: 13px;
      line-height: 1.55;
    }

    /* ===== Existing collections list ===== */
    .stack{
      display:flex;
      flex-direction:column;
      gap: 10px;
      margin-top: 12px;
    }
    .item{
      border: 1px solid rgba(255,255,255,0.08);
      background: rgba(255,255,255,0.02);
      border-radius: 16px;
      padding: 12px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
    }
    .item:hover{
      transform: translateY(-1px);
      border-color: rgba(180,207,106,0.35);
      background: rgba(180,207,106,0.06);
    }
    .itemLeft{
      display:flex;
      flex-direction:column;
      gap: 4px;
      min-width:0;
    }
    .itemName{
      font-weight: 950;
      color: var(--text-2);
      font-size: 13px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .itemSlug{
      font-family: var(--mono);
      font-size: 11px;
      color: rgba(255,255,255,0.45);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .itemRight{
      display:flex;
      align-items:center;
      gap: 8px;
      flex: 0 0 auto;
    }

    /* Small icon button */
    .iconBtn{
      width: 38px; height: 38px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.10);
      background: rgba(255,255,255,0.03);
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
    }
    .iconBtn:hover{
      transform: translateY(-1px);
      border-color: var(--stroke-2);
      background: rgba(255,255,255,0.05);
    }
    .iconBtn svg{ width: 18px; height: 18px; stroke: rgba(255,255,255,0.80); }

  </style>
</head>

<body>
  <div class="app">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="brand">
        <div class="orb"></div>
        <div class="brandText">
          <strong>Dream OS</strong>
          <span>Internal studio console</span>
        </div>
      </div>

      <nav class="nav" aria-label="Primary">
        <a href="dashboard.html"><span>Dashboard</span><small>⌘1</small></a>
        <a href="create.html"><span>Create</span><small>⌘2</small></a>
        <a class="active" href="collections.html"><span>Collections</span><small>⌘3</small></a>
        <a href="distribute.html"><span>Distribute</span><small>⌘4</small></a>
        <a href="socials.html"><span>Socials</span><small>⌘5</small></a>
        <a href="website.html"><span>Website</span><small>⌘6</small></a>
        <a href="#"><span>Settings</span><small>⌘7</small></a>
      </nav>

      <div class="sidebar-footer">
        <button class="logout-btn" type="button" onclick="alert('Hook logout');">
          <span>Logout</span><small>Esc</small>
        </button>
      </div>
    </aside>

    <!-- Scrim for mobile -->
    <div class="scrim" id="scrim" onclick="toggleSidebar(false)"></div>

    <!-- Main -->
    <main class="main">
      <!-- Topbar -->
      <div class="topbar">
        <div class="topLeft">
          <button class="burger" id="burger" aria-label="Open menu" onclick="toggleSidebar()">
            <svg viewBox="0 0 24 24" fill="none">
              <path d="M5 7h14M5 12h14M5 17h14" stroke-width="1.8" stroke-linecap="round"/>
            </svg>
          </button>

          <div class="crumbs">
            <div class="kicker">Collections</div>
            <div class="title">New Collection</div>
          </div>
        </div>

        <div class="topRight">
          <div class="pill">Build: v0.1</div>
          <button class="btn" type="button" onclick="window.location.href='collections.html'">View all</button>
        </div>
      </div>

      <div class="content">
        <section class="panel">
          <div class="head">
            <h2>Create a Collection</h2>
            <div class="pill">Non-destructive grouping</div>
          </div>

          <div class="body">
            <div class="collections-grid">
              <!-- LEFT: Form -->
              <div class="panel" style="background:transparent; border:0; box-shadow:none;">
                <div style="display:flex; flex-direction:column; gap:12px;">
                  <div class="field">
                    <div class="label">
                      Collection name
                      <span class="hint">Human-facing title</span>
                    </div>
                    <input id="colName" type="text" placeholder="War & Feast" />
                  </div>

                  <div class="two">
                    <div class="field">
                      <div class="label">
                        Slug
                        <span class="hint">URL-safe</span>
                      </div>
                      <input id="colSlug" type="text" placeholder="war-and-feast" />
                    </div>

                    <div class="field">
                      <div class="label">
                        Visibility
                        <span class="hint">Default</span>
                      </div>
                      <select id="colVisibility">
                        <option value="private">Private</option>
                        <option value="unlisted">Unlisted</option>
                        <option value="public" selected>Public</option>
                      </select>
                    </div>
                  </div>

                  <div class="field">
                    <div class="label">
                      Description
                      <span class="hint">Short, archive-ready</span>
                    </div>
                    <textarea id="colDesc" placeholder="A dossier of rituals, appetite, and power structures."></textarea>
                  </div>

                  <div class="field">
                    <div class="label">
                      Cover image
                      <span class="hint">Optional</span>
                    </div>

                    <div class="uploadRow">
                      <label class="fileBtn" for="coverFile">
                        <span class="dot" aria-hidden="true"></span>
                        Upload cover
                      </label>
                      <div class="fileMeta" id="fileMeta">No file selected</div>
                    </div>

                    <input id="coverFile" type="file" accept="image/*" />
                  </div>

                  <div class="formActions">
                    <button class="btn primary" type="button" onclick="saveCollection()">
                      <span class="dot"></span>Create Collection
                    </button>
                    <button class="btn" type="button" onclick="resetForm()">Reset</button>
                  </div>
                </div>
              </div>

              <!-- RIGHT: Preview + Existing -->
              <div>
                <div class="previewCard">
                  <div class="previewTop">
                    <div class="title">Live Preview</div>
                    <div class="badge" id="previewVis">public</div>
                  </div>

                  <div class="previewBody">
                    <div class="coverMock" id="coverMock">
                      <div class="ghost">
                        <span id="previewSlug">war-and-feast</span>
                        <span>cover</span>
                      </div>
                    </div>

                    <div class="previewMeta">
                      <div class="name" id="previewName">War &amp; Feast</div>
                      <div class="desc" id="previewDesc">
                        A dossier of rituals, appetite, and power structures.
                      </div>
                    </div>
                  </div>
                </div>

                <div class="stack">
                  <div class="pill" style="width:fit-content;">Existing</div>

                  <div class="item">
                    <div class="itemLeft">
                      <div class="itemName">Signals &amp; Ascensions</div>
                      <div class="itemSlug">signals-and-ascensions</div>
                    </div>
                    <div class="itemRight">
                      <div class="badge">public</div>
                      <button class="iconBtn" type="button" onclick="alert('Open collection');" aria-label="Open">
                        <svg viewBox="0 0 24 24" fill="none">
                          <path d="M9 18l6-6-6-6" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                      </button>
                    </div>
                  </div>

                  <div class="item">
                    <div class="itemLeft">
                      <div class="itemName">Industrial Scriptures</div>
                      <div class="itemSlug">industrial-scriptures</div>
                    </div>
                    <div class="itemRight">
                      <div class="badge">unlisted</div>
                      <button class="iconBtn" type="button" onclick="alert('Open collection');" aria-label="Open">
                        <svg viewBox="0 0 24 24" fill="none">
                          <path d="M9 18l6-6-6-6" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                      </button>
                    </div>
                  </div>

                  <div class="item">
                    <div class="itemLeft">
                      <div class="itemName">The Digital Unconscious</div>
                      <div class="itemSlug">digital-unconscious</div>
                    </div>
                    <div class="itemRight">
                      <div class="badge">private</div>
                      <button class="iconBtn" type="button" onclick="alert('Open collection');" aria-label="Open">
                        <svg viewBox="0 0 24 24" fill="none">
                          <path d="M9 18l6-6-6-6" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                      </button>
                    </div>
                  </div>

                </div>
              </div>
            </div>
          </div>
        </section>
      </div>
    </main>
  </div>

  <script>
    // Sidebar toggle (matches your burger/scrim pattern)
    function toggleSidebar(force){
      const sidebar = document.getElementById('sidebar');
      const scrim = document.getElementById('scrim');
      const burger = document.getElementById('burger');

      const willOpen = (typeof force === 'boolean') ? force : !sidebar.classList.contains('open');

      sidebar.classList.toggle('open', willOpen);
      scrim.classList.toggle('show', willOpen);
      burger.classList.toggle('active', willOpen);
    }

    // Live preview wiring
    const nameEl = document.getElementById('colName');
    const slugEl = document.getElementById('colSlug');
    const descEl = document.getElementById('colDesc');
    const visEl  = document.getElementById('colVisibility');
    const fileEl = document.getElementById('coverFile');

    const pName = document.getElementById('previewName');
    const pSlug = document.getElementById('previewSlug');
    const pDesc = document.getElementById('previewDesc');
    const pVis  = document.getElementById('previewVis');
    const fileMeta = document.getElementById('fileMeta');
    const coverMock = document.getElementById('coverMock');

    function slugify(v){
      return (v || '')
        .toLowerCase()
        .trim()
        .replace(/['"]/g,'')
        .replace(/\s+/g,'-')
        .replace(/[^a-z0-9\-]/g,'')
        .replace(/\-+/g,'-');
    }

    function syncPreview(){
      const name = nameEl.value.trim() || 'War & Feast';
      const slug = slugEl.value.trim() || slugify(name) || 'war-and-feast';
      const desc = descEl.value.trim() || 'A dossier of rituals, appetite, and power structures.';
      const vis  = visEl.value;

      pName.textContent = name;
      pSlug.textContent = slug;
      pDesc.textContent = desc;
      pVis.textContent = vis;
    }

    nameEl.addEventListener('input', () => {
      // auto-fill slug only if user hasn't touched slug much
      if (!slugEl.dataset.touched){
        slugEl.value = slugify(nameEl.value);
      }
      syncPreview();
    });

    slugEl.addEventListener('input', () => {
      slugEl.dataset.touched = "1";
      syncPreview();
    });

    descEl.addEventListener('input', syncPreview);
    visEl.addEventListener('change', syncPreview);

    fileEl.addEventListener('change', () => {
      const f = fileEl.files && fileEl.files[0];
      if (!f){
        fileMeta.textContent = 'No file selected';
        coverMock.style.backgroundImage = '';
        syncPreview();
        return;
      }
      fileMeta.textContent = f.name;

      // tiny preview: set as background image (non-destructive, only UI)
      const url = URL.createObjectURL(f);
      coverMock.style.background = `
        radial-gradient(650px 220px at 30% 20%, rgba(180,207,106,0.08), transparent 60%),
        radial-gradient(520px 240px at 85% 30%, rgba(120,90,255,0.10), transparent 60%),
        url(${url}) center/cover no-repeat
      `;
      syncPreview();
    });

    function resetForm(){
      nameEl.value = '';
      slugEl.value = '';
      delete slugEl.dataset.touched;
      descEl.value = '';
      visEl.value = 'public';
      fileEl.value = '';
      fileMeta.textContent = 'No file selected';
      coverMock.style.background = `
        radial-gradient(650px 220px at 30% 20%, rgba(180,207,106,0.10), transparent 60%),
        radial-gradient(520px 240px at 85% 30%, rgba(120,90,255,0.14), transparent 60%),
        rgba(255,255,255,0.02)
      `;
      syncPreview();
    }

    function saveCollection(){
      // Hook this to your backend later
      const payload = {
        name: nameEl.value.trim(),
        slug: slugEl.value.trim(),
        description: descEl.value.trim(),
        visibility: visEl.value,
      };
      alert('Hook to POST /api/collections\n\n' + JSON.stringify(payload, null, 2));
    }

    // initial preview
    syncPreview();
  </script>
</body>
</html>
